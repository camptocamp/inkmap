<!DOCTYPE html><html class="default" lang="en" data-base="./"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@camptocamp/inkmap</title><meta name="description" content="Documentation for @camptocamp/inkmap"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="index.html" class="title">@camptocamp/inkmap</a><div id="tsd-toolbar-links"><a href="https://camptocamp.github.io/inkmap/main/">Examples</a></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"></div><div class="tsd-panel tsd-typography"><div style="text-align: center"><strong>inkmap</strong>, a library for generating high resolution maps in the browser</div>
<h5 id="live-demo-here" class="tsd-anchor-link"><a href="https://camptocamp.github.io/inkmap/main/">Live demo here!</a><a href="#live-demo-here" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h5><h2 id="introduction" class="tsd-anchor-link">Introduction<a href="#introduction" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p><strong>inkmap</strong> is based on <a href="https://www.openlayers.org">OpenLayers</a> and will generate maps in PNG format based on a given JSON specification.</p>
<p><strong>inkmap</strong> can handle long-running jobs (e.g. A0 format in 300 dpi) and provides an API for following a job progress.
It uses a service worker in the background provided the user browser supports <a href="https://developer.mozilla.org/en-US/docs/Web/API/OffscreenCanvas">OffscreenCanvas</a>, and falls back (almost) seamlessly to the main thread if not.</p>
<p>Please note that the first version of <strong>inkmap</strong> has been entirely funded and supported by the <a href="https://www.ecologie.gouv.fr/">French Ministry of Ecology</a> as part of their Descartes web mapping toolkit, hosted here: <a href="https://adullact.net/projects/descartes/">https://adullact.net/projects/descartes/</a></p>
<h2 id="usage" class="tsd-anchor-link">Usage<a href="#usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="basic" class="tsd-anchor-link">Basic<a href="#basic" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>To include the library in your project:</p>
<pre><code class="bash"><span class="hl-0">$</span><span class="hl-1"> </span><span class="hl-2">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-3">--save</span><span class="hl-1"> </span><span class="hl-2">@camptocamp/inkmap</span>
</code><button type="button">Copy</button></pre>

<p>Then import the different methods from the <code>inkmap</code> package:</p>
<pre><code class="js"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">print</span><span class="hl-1">, </span><span class="hl-5">downloadBlob</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@camptocamp/inkmap&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">print</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">layers:</span><span class="hl-1"> [ ... ],</span><br/><span class="hl-1">  </span><span class="hl-5">projection:</span><span class="hl-1"> </span><span class="hl-2">&#39;EPSG:4326&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  ...</span><br/><span class="hl-1">}).</span><span class="hl-0">then</span><span class="hl-1">(</span><span class="hl-5">downloadBlob</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<h3 id="advanced" class="tsd-anchor-link">Advanced<a href="#advanced" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>inkmap</strong> offers advanced job monitoring through the use of Observables provided by the <a href="https://rxjs.dev/">rxjs</a> library.</p>
<p>Observables are different from Promises in that they can emit <em>multiple values</em> instead of just one, and are a very good fit for progress reporting.</p>
<p>To use an Observable, simply call its <code>subscribe()</code> method with a function as argument. The function will be called anytime a new value is emitted, like so:</p>
<pre><code class="js"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">getJobStatus</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@camptocamp/inkmap&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-1">...</span><br/><br/><span class="hl-0">getJobStatus</span><span class="hl-1">(</span><span class="hl-5">jobId</span><span class="hl-1">).</span><span class="hl-0">subscribe</span><span class="hl-1">((</span><span class="hl-5">jobStatus</span><span class="hl-1">) </span><span class="hl-3">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">// do something with the status</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>Note that for <em>long-lived Observables</em> (i.e. Observables that never completes) it is important to call <code>unsubscribe()</code> when the emitted values are not needed anymore. Open subscriptions to Observables might create memory leaks.</p>
<h3 id="enabling-the-service-worker" class="tsd-anchor-link">Enabling the service worker<a href="#enabling-the-service-worker" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><strong>inkmap</strong> can <em>and will</em> use a dedicated service worker for running print jobs if given the chance. This offers the following
advantages:</p>
<ul>
<li>Jobs run in a separate thread, meaning the user navigation will not be impacted at all by any CPU-intensive task</li>
<li>The service worker isn't tied to a window or tab, so jobs will continue running when the tab is closed (and even when the browser is closed, depending on the platform)</li>
<li>Push notifications might be sent to the user when a print job complete (not implemented yet)</li>
</ul>
<p><strong>To enable this, the <code>inkmap-worker.js</code> file located in the <code>dist</code> folder must be published on the same path as the application
using inkmap</strong>.</p>
<p>The worker file can be published either using a symbolic link or by actually copying the file, for example in the application build pipeline.</p>
<p>If using Webpack to build the application, a solution is to use the <a href="https://webpack.js.org/plugins/copy-webpack-plugin/">CopyWebpackPlugin</a>:</p>
<pre><code class="js"><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-4">default</span><span class="hl-1"> {</span><br/><span class="hl-1">  ...</span><br/><span class="hl-1">  </span><span class="hl-5">plugins</span><span class="hl-1">: [</span><br/><span class="hl-1">     </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">CopyWebpackPlugin</span><span class="hl-1">([</span><br/><span class="hl-1">       {</span><br/><span class="hl-1">         </span><span class="hl-5">from:</span><span class="hl-1"> </span><span class="hl-2">&#39;node_modules/@camptocamp/inkmap/dist/inkmap-worker.js&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">         </span><span class="hl-5">to:</span><span class="hl-1"> </span><span class="hl-2">&#39;dist&#39;</span><br/><span class="hl-1">       },</span><br/><span class="hl-1">     ]),</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  ...</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h2 id="api" class="tsd-anchor-link">API<a href="#api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Important note: all API functions are named exports from the <code>inkmap</code> package.</p>
<p>See the <a href="https://camptocamp.github.io/inkmap/main/docs/">API documentation</a> website.</p>
<h2 id="architecture" class="tsd-anchor-link">Architecture<a href="#architecture" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Under the hood, <code>inkmap</code> will attempt to install a service worker on the page it is called. The service worker will then be in charge
of loading all the map images and data, composing them together and giving them back to the application code.</p>
<h2 id="contributing" class="tsd-anchor-link">Contributing<a href="#contributing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>See <a href="media/CONTRIBUTING.md">CONTRIBUTING</a>.</p>
<h2 id="license" class="tsd-anchor-link">License<a href="#license" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p><a href="https://cecill.info/licences/Licence_CeCILL-C_V1-en.txt">CeCILL-C</a></p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><ul><li><ul><li><ul><li><a href="#live-demo-here"><span>Live demo here!</span></a></li></ul></li></ul></li></ul><a href="#introduction"><span>Introduction</span></a><a href="#usage"><span>Usage</span></a><ul><li><a href="#basic"><span>Basic</span></a></li><li><a href="#advanced"><span>Advanced</span></a></li><li><a href="#enabling-the-service-worker"><span>Enabling the service worker</span></a></li></ul><a href="#api"><span>API</span></a><a href="#architecture"><span>Architecture</span></a><a href="#contributing"><span>Contributing</span></a><a href="#license"><span>License</span></a></div></details></div><div class="site-menu"><nav id="tsd-sidebar-links" class="tsd-navigation"><a href="https://camptocamp.github.io/inkmap/main/" class="tsd-nav-link">Examples</a></nav><nav class="tsd-navigation"><a href="modules.html">@camptocamp/inkmap</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
